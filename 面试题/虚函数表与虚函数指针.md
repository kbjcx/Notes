---
area: C++
tags: []
date: 2023-08-24 19:48
---
凡是声明有虚函数的类，其对象都含有一个隐藏的 data member，用来指向该 class 的 vtbl。这个隐藏的 data member 就是 vptr（virtual table Pointer）

**非继承的类**: 
- 如果一个类中有虚函数，则该类就有一个虚函数表。==虚函数表是属于类的，不属于类对象。在编译的时候确定，存放在只读数据段。==
- 每一个实例化的类对象都有一个虚函数表指针，指向类的虚函数表。虚函数表指针属于类对象。存放在堆上或者栈上。

**继承的类**: 
- 如果基类中有虚函数，派生类实现或没实现，都有虚函数表。基类的虚函数表和派生类的虚函数表不是同一个表。
- 如果派生类没有重写基类的虚函数，则派生类的虚函数表和基类的虚函数表的内容是一样的。
- 如果派生类重写了基类的虚函数，则在派生类的虚函数表中用的是派生类的函数。

**多继承**:
- 含有虚函数的==基类有多少个，派生类就有多少个虚函数表指针，派生类有就有多少个虚函数表==
- 派生类有的而基类没有的虚函数，添加在第一个虚函数表中
- 虚函数表的结尾如果不是 0, 则表示还有下一个虚函数表

**虚函数的作用**是允许在派生类中重新定义与基类同名的函数，并且可以通过基类指针或者引用来访问基类和派生类中的同名函数


---
