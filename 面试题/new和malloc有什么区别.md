---
area: C++
tags: []
date: 2023-08-24 14:33
---
- **申请的内存所在位置**: new 操作符从*自由存储区（free store*）上为对象动态分配内存空间，而 malloc 函数从堆上动态分配内存

> [!info] 自由存储区
> 只要是使用 malloc 开辟的内存都会在堆上, 而 new 在不重载 operator new ()的前提下, new 底层会默认调用 malloc 来分配内存, 但是当重载 operator new ()之后, 可以自定义内存分配的来源, 也就是自由存储区

- **返回类型安全性**: `new` 操作符内存分配成功时，返回的是对象类型的指针，类型严格与对象匹配，无须进行类型转换，故 `new` 是符合类型安全性的操作符。而 `malloc` 内存分配成功则是返回 `void *` ，需要通过强制类型转换将 `void*`指针转换成我们需要的类型
- **内存分配失败时的返回值**: `new` 内存分配失败时，会抛出 `bad_alloc` 异常，它不会返回 `NULL`；`malloc` 分配内存失败时返回 `NULL`
---
