---
area: 操作系统
tags: [TODO]
date: 2023-04-12 18:48
---
这个问题的关键在于 3 点:
1. 操作系统是 32 位还是 64 位
2. 申请完内存之后会不会进行访问
3. 操作系统有没有开启 [[内存交换|Swap]] 机制

根据**[[虚拟内存]]**可知:
操作系统为进程分配的内存是虚拟内存, 当进程需要访问该虚拟内存地址时才会将物理地址与该虚拟地址进行映射, 因此, **<font color="#0593A2">如果只是申请虚拟内存地址是不会占据物理内存地址空间的</font>**. 
如果发现当前访问的虚拟地址还没有映射到物理地址, 就会触发**[[缺页中断]]**, 此时进程会从用户态切换到内核态, 并将缺页中断交给内核的缺页中断处理函数处理. 

![[缺页中断#^58db4a]]

> [!info] 
> 内核中存在检测内存申请是否合理的算法. 可能导致大内存申请失败, 但是可以关闭检测来实现大内存申请

> [!important] 
> 申请的最大虚拟内存一般还会受到物理内存大小的限制, 因为在申请虚拟内存时, 还是会使用到物理内存, 比如保存虚拟内存的数据结构

- **[[内存交换|Swap]] 机制对内存申请的影响**
    - 如果没有开启 Swap 机制, 当申请的内存超过了空闲内存的大小就会触发**[[OOM]]**机制
    - 如果开启了 Swap 机制程序就可以正常运行
- 内存交换
    - Swap 在**[[内存回收#^795ad8|后台内存回收]]**和**[[内存回收#^7af436|直接内存回收]]**时都会发生, 主要取决于回收的的内存页的类型「 [[内存回收#哪些内存可以被回收 ?]] 」

    ![[内存交换#Description]]




---
#### Expend
- [[如果申请成功内核是怎么做的, 不成功内核又是怎么做的]]