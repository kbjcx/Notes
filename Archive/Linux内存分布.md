---
aliases: []
area: 操作系统
project: 
date: 2023-04-12 11:10
---
---
#### Description
在 Linux 操作系统中, 虚拟地址空间被分为<font color="#0593A2">内核空间</font>和<font color="#0593A2">用户空间</font>, 不同位数的操作系统, 地址空间范围也是不同的
![[Pasted image 20230412111346.png]]
- 对于 32 位系统, 内核空间占 1G , 位于最高处, 用户空间占余下 3G
- 对于 64 位系统, 内核空间占据最高处的 128T, 用户空间占据最低处的 128T, 余下的是未定义的空间

对于每个进程而言, 虚拟内存中都有自己的内核空间, 但是不同进程的内核空间关联的都是相同的物理内存地址, 这样进程切换到内核态后, 就可以很方便的访问内核空间内存
![[Pasted image 20230412112412.png]]

- 用户内存空间划分
    用户空间从低到高划分为 6 种不同的内存段
    ![[Pasted image 20230412112911.png]]
    - 代码段: 包含二进制可执行代码
    - 数据段: 包含已初始化的静态变量和全局变量
    - BSS 段: 包含未初始化的静态变量和全局变量
    - 堆段: 包含动态分配的内存, 从低地址开始向上增长
    - 文件映射段: 包含动态库, 共享内存等, 从低地址开始向上增长
    - 栈段: 包含局部变量和函数调用的上下文等, 栈的大小一般是固定的, 一般是 `8MB`

---
#### Source
- [4.2 malloc 是如何分配内存的？ | 小林coding](https://xiaolincoding.com/os/3_memory/malloc.html#linux-%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E5%B8%83%E9%95%BF%E4%BB%80%E4%B9%88%E6%A0%B7)