---
aliases: []
area: C++
project: 
date: 2023-08-25 20:26
tags: []
---
---
#### Content
> [!faq] 为什么要引入虚基类?
> 如果一个派生类是从多个基类派生出来的，而这些基类又有一个共同的基类，则在这个派生类中访问这个共同的基类中的成员时，可能会产生二义性. 也就是**菱形继承**问题

如果将公共基类说明为虚基类。那么，对同一个虚基类的构造函数只调用一次，这样从不同的路径继承的虚基类的成员在内存中就只拥有一个拷贝。从而解决了以上的二义性问题

此时子类的构造如下:
![[Pasted image 20230825204311.png|300]]

不再将积累的成员直接拷贝到派生类的空间, 而是虚继承的子类继承了基类的虚基类表, 将虚基类表指针存储在派生类的内存中. 虚基类的成员直接存储在孙子类的内存空间中. 

当派生类需要访问虚基类的成员变量时, 通过虚基类表中存储的偏移量, 加上虚基类表指针的地址得到虚基类的成员变量的存储地址


---
