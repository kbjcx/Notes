---
aliases: [SDS]
area: redis
project: 
date: 2023-07-21 22:28
tags: []
---
---
#### Description
- 用 `sdshdr` 结构体来存储字符串, 定义如下:
```cpp
struct sdshdr {
    int len; // buffer中已使用的长度, 即字符串的长度
    int free; // 剩余的字节大小
    char buf[]; // 存储字符串的字符数组
};
```

> [!attention] 
> `SDS` 的 `buf` 中存储时依然采取了 C 字符串的表示方法, 在字符串末尾添加 `\0` 来表示结束, 这是为了能够兼容部分 C 字符串函数采取的措施. 并且, 插入 `\0` 的过程是透明的, 由内部实现自动添加, 不会占据 `len` 和 `free` 的空间, 因此 `buf` 的实际长度为 `len + free + 1`
![[Pasted image 20230721223407.png]]

##### SDS 相对于 C 字符串的优点
1. 常数复杂度获取字符串长度
2. 杜绝缓冲区溢出
    采用动态分配字符数组长度来杜绝了缓冲区溢出
3. 减少修改字符串时带来的
---
#### Source
