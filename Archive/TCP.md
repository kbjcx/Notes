---
aliases: []
area: 计算机网络
project: 
date: 2023-06-13 17:01
tags: []
---
---
#### Description
> [!note] TCP 是面向连接的、可靠的、基于字节流的传输层通信协议
##### TCP 头格式
![[Pasted image 20230613170227.png|500]]
- **<font color="#0593A2">序列号</font>**: 解决网络包乱序问题
- **<font color="#0593A2">确认号</font>**: 解决丢包问题

##### TCP 三次握手
![[Pasted image 20230613173041.png|500]]

- 为什么需要三次握手？
    - 确认双方都具备收发能力
    - 确保可靠的同步双方的序列号
    - 阻止重复历史连接
    - 避免资源浪费

- 为什么序列号需要随机初始化？
    - 防止历史报文被相同的四元组接收
    - 为了安全性，防止收到伪造了序列号的报文

- 既然 IP 层会进行分片，为什么 TCP 还需要 MSS？
    - 如果交由 IP 来分片的话，当出现丢包时，需要重传整个 TCP 报文的所有分片
    - 由 TCP 分片的话就只用重传 TCP 的分片即可

##### TCP 四次挥手
![[Pasted image 20230613175302. png]|500]

- 为什么挥手需要四次？
    - 服务端回复 ACK 之后可能还有数据需要发送，当数据发送完毕后才会回复 FIN。

- 为什么 TIME_WAIT 等待的时间是 2MSL？
    - 至少允许报文丢失一次，当服务端没有收到客户端的 ACK 时，会重传 FIN，客户端收到 FIN 会重置计时，而允许重传的 FIN 报文


---
#### Source
