---
aliases: [Pipe]
area: 操作系统
project: 
date: 2023-04-15 10:02
---
---
#### Description
> [!important] 
> 管道传输数据是单向的, 并且管道的读和写都是阻塞的, 只有等到另一个操作才能解除阻塞, 因此管道的通信效率低, 不适合频繁的进程间通信

**匿名管道**
> [!note] 
> 匿名管道的本质就是存在于内核中的一段缓存, 分别通过以读和写的方式打开为两个文件描述符, 通过写端描述符写入缓存, 在通过读端描述符取出缓存数据. 
```cpp
int pipe(int fd[2])
// 返回两个文件描述符, 一个是读端文件描述符fd[0], 一个是写端文件描述符fd[1]
```
创建的子进程通过继承父进程的文件描述符来获取到管道的读写能力, 但是由于管道数据的缓存只有一块, 当父进程和子进程同时使用管道文件描述符写数据或读数据时会产生冲突. 因此管道使用时往往创建两个管道用于读和写, 同时关闭管道的某一端, 是的管道在进程间的读写也是单向的. 
![[Pasted image 20230415102549.png|500]]

> [!tip] 
> 当然也可以使用信号来解决这种冲突, 使得同一时间只有一个进程能够读取和写入管道, 同时需要把管道缓存的数据一次性读完

匿名管道的通信范围只存在于父子关系的进程之间, 因为只有继承父进程的文件描述符才能用于通信

匿名管道的生命周期随进程结束而结束

**缺点**
1. 只能在具有父子关系的进程之间才能用
2. 用于半双工通信, 并且管道的读和写都是堵塞的, 通信效率低

**命名管道**
> [!note] 
> 命名管道的本质是创建一个内存级的文件, 进程可以通过以读写的方式打开文件来实现进程间通信

**<font color="#0593A2">可以在不相关的进程间进行通信</font>**, 因为命令管道，提前创建了一个类型为管道的设备文件，在进程里只要使用这个设备文件，就可以相互通信

**缺点:**
1. 占用文件资源, 不再使用时需要手动关闭
2. 命名管道是阻塞的, 读取端和写入端的顺序很重要, 可能导致进程阻塞或是死锁

---
#### Source
- [5.2 进程间有哪些通信方式？ | 小林coding](https://xiaolincoding.com/os/4_process/process_commu.html#%E7%AE%A1%E9%81%93)
- [管道读写的阻塞与非阻塞](https://www.dgrt.cn/a/1635712.html?action=onClick)